---
import Layout from "@/layouts/Layout.astro";
import { ResetPasswordForm, InvalidTokenView } from "@/components/auth/ResetPasswordForm";

const code = Astro.url.searchParams.get("code");

let hasSession = false;

if (code) {
  const { error } = await Astro.locals.supabase.auth.exchangeCodeForSession(code);
  hasSession = !error;
}
---

<Layout title="Reset Password - 10x Recipes">
  <main class="min-h-screen flex items-center justify-center p-4">
    {hasSession ? <ResetPasswordForm client:load /> : <InvalidTokenView client:load />}
  </main>
</Layout>
